---
const user = { 
  name: "Jean Dupont", 
  avatar: "https://i.pravatar.cc/64?u=jd" 
};

const navItems = [
  { href: "/configurateur", label: "Configurateur" },
  { href: "/mes-modeles", label: "Ma Collection" },
  { href: "/histoire", label: "Notre Histoire" }
];
---

<header class="sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm">
  <nav class="navbar max-w-7xl mx-auto px-6 h-16">
    <!-- Logo -->
    <div class="navbar-start">
      <a href="/" class="flex items-center gap-2 text-2xl font-serif font-semibold text-[#2C3E50] hover:opacity-80 transition-opacity">
        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7z"/>
          <circle cx="12" cy="12" r="3"/>
        </svg>
        TaVue
      </a>
    </div>

    <!-- Navigation centrale -->
    <div class="navbar-center hidden lg:flex">
      <ul class="menu menu-horizontal gap-1 px-1">
        {navItems.map(item => (
          <li>
            <a 
              href={item.href} 
              class="text-sm font-medium text-gray-700 hover:text-[#2C3E50] hover:bg-gray-100 rounded-md px-4 py-2 transition-all"
            >
              {item.label}
            </a>
          </li>
        ))}
      </ul>
    </div>

    <!-- Actions droite -->
    <div class="navbar-end gap-3">
      <!-- Bouton mobile menu -->
      <div class="dropdown dropdown-end lg:hidden">
        <label tabindex="0" class="btn btn-ghost btn-circle">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </label>
        <ul tabindex="0" class="dropdown-content menu p-2 shadow-lg bg-white rounded-lg w-52 mt-3 border border-gray-200">
          {navItems.map(item => (
            <li><a href={item.href} class="text-sm">{item.label}</a></li>
          ))}
        </ul>
      </div>

      <!-- Avatar utilisateur -->
      <div class="dropdown dropdown-end">
        <label tabindex="0" class="btn btn-ghost btn-circle avatar">
          <div class="w-9 h-9 rounded-full ring-2 ring-gray-200 ring-offset-2">
            <img 
              alt={user.name} 
              src={user.avatar} 
              loading="lazy"
              class="rounded-full object-cover"
            />
          </div>
        </label>
        <ul tabindex="0" class="dropdown-content menu p-2 shadow-lg bg-white rounded-lg w-56 mt-3 border border-gray-200">
          <li class="menu-title px-4 py-2">
            <span class="text-sm font-semibold text-gray-900">{user.name}</span>
          </li>
          <div class="divider my-1"></div>
          <li><a href="/mes-modeles" class="text-sm">Mes modèles</a></li>
          <li><a href="/configurateur" class="text-sm">Configurateur</a></li>
          <div class="divider my-1"></div>
            <li>
            <a href="/login" id="login-btn" class="text-sm">
              Se connecter
            </a>
            </li>
          <li>
            <button id="logout-btn" class="text-sm text-red-600">
              Se déconnecter
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const logoutBtn = document.getElementById('logout-btn');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', async () => {
        if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
          try {
            // Supprimer le cookie d'authentification
            document.cookie = "pb_auth=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT";
            
            // Rediriger vers la page d'accueil
            window.location.href = '/';
          } catch (error) {
            console.error('Erreur de déconnexion:', error);
            alert('Erreur lors de la déconnexion');
          }
        }
      });
    }
  });
</script>